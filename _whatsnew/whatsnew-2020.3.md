##########################
##    Текущая версия    ##
##########################

<a id="05102021"></a>
# Версия - 2020.3 (Fix)
#### от 05.10.2021 (build 05102021)

## Исправления

- Исправлена работа раздела Отчеты
- Исправлена работа раздела "Каледарь на месяц"


<a id="27082021"></a>
# Версия - 2020.3 (Fix)
#### от 27.08.2021 (build 27082021)

## Исправления

- Массовые действия для Клиентов - снято ограничение в 1000 записей для администраторов для:
  - предоставления доступа
  - изменения типа отношений
  - изменения территории
  
- Массовые действия для Сделок - снято ограничение в 500 записей для администраторов для:
- предоставления доступа


<a id="27082021"></a>
# Версия - 2020.3 (Fix)
#### от 27.08.2021 (build 27082021)

## Исправления

- Установщик
  - исправление ошибки на шаге 3

- Документы
  - Обновлен шаблон счета-фактуры в соответствие с постановлением Правительства Российской Федерации от 2 апреля 2021 г. № 534 (входит в дистрибутив, Word)
  - Добавлен тэг для шаблонов:
    - количество позиций (spekaCount)
  - Обновлен шаблон Счета-фактуры ( [Документация](https://salesman.pro/docs/10) )


<a id="25082021"></a>
# Версия - 2020.3 (Fix)
#### от 25.08.2021 (build 25082021)

## Исправления

- Панель управления
  - Исправлено переименование шаблона акта, а также создание нового шаблона

- Плагин "Универсальный автоотправитель"
  - Исправлена отправка email

- Карточка сделки
  - Исправлено удаление доступа

- Общее
  - исправлен расчет количества активных сотрудников, в соответствие с лицензией
  - в экспорт сделок добавлен Отдел, к которому относится ответственный за сделку


<a id="30072021"></a>
# Версия - 2020.3 (Fix)
#### от 30.07.2021 (build 30072021)

>
> <b class="red">Важно:</b> Рекомендуется запуск скрипта /_install/update.php для внесения изменений в структуру БД (оптимизация для Проектов и Обсуждений)
>

## Исправления

- Исправлено отображение загруженного логотипа
- Редактор шаблона счета, акта - исправлен показ даты редактирования

- Модуль "Обсуждения"
  - исправлены уведомления при начале нового обсуждения
  - добавлен текст сообщения при начале нового обсуждения

- Модуль "Проекты"
  - исправление доступа к смене статуса работ в списках и в карточках

- Карточка сделки
  - исправлено снятие доступа для сотрудников при добавлении Контрольной точки


<a id="10072021"></a>
# Версия - 2020.3 (Fix)
#### от 10.07.2021 (build 10072021)

## Исправления

- Печать ежедневника
  - добавлена возможность прокрутки списка

- Сделки
  - в экспорт добавлены признаки "Отрасль" и "Территория" клиента (опционально)

- Панель управления
  - выбор тем оформления для редактора пользователей


<a id="02072021"></a>
# Версия - 2020.3 (Fix)
#### от 02.07.2021 (build 02072021)

## Исправления

- Экспорт истории активностей
  - исправления

- Модуль "ЦИЗ"
  - исправление добавления задания


<a id="10062021"></a>
# Версия - 2020.3 (Fix)
#### от 10.06.2021 (build 10062021)

## Исправления

- Исправление обновления


<a id="04062021"></a>
# Версия - 2020.3 (Fix)
#### от 04.06.2021 (build 04062021)

## Исправления

- Отчеты по оплаченным счетам
  - добавлена колонка "Маржа по сделке"
  - добавлена колонка "Направление"

- Панель управления
  - возможность подписать сотрудника на кастомные уведомления (из модулей)

- Модуль "Сборщик заявок"
  - исправлены ссылки на API

- Модуль "Обсуждения"
  - добавлен текст ответа в обсуждении
  
- Раздел "Напоминания, дела"
  - в экспорт добавлены признаки Важность и Срочность
  
- Создание резервной копии БД
  - оптимизация


<a id="29032021"></a>
# Версия - 2020.3 (Fix)
#### от 29.03.2021 (build 29032021)

## Исправления

- Напоминания
  - исправлено удаление напоминаний

- Модуль "Метрика"
  - исправлен расчет и вывод фактических недельных показателей

- Прочие мелкие исправления


<a id="10032021"></a>
# Версия - 2020.3 (Fix)
#### от 10.03.2021 (build 10032021)

## Исправления

- Модуль "Метрика"
  - исправлен расчет повторных продаж
  - исправлен учет уточненных условий для расчета некоторых KPI:
    - повторные продажи
    - выставленные счета
    - оплаченные счета

- Модуль "Каталог-склад"
  - исправлено определение прав пользователей-координаторов
  - исправлен вывод категорий с учетом отмеченных для модуля категорий Прайса

- Плагин "Уведомление пользователей (боты)"
  - небольшие исправления


<a id="26022021"></a>
# Версия - 2020.3 (Fix)
#### от 26.02.2021 (build 26022021)

## Исправления

- Выставленные счета
  - добавлено отображение даты выставления счета в списке

- Проекты
  - доработка поддержки PHP Hook ( [Документация](https://salesman.pro/api2/hooks) )


<a id="15022021"></a>
# Версия - 2020.3 (Fix)
#### от 15.02.2021 (build 15022021)

## Исправления

- Сделки
  - перенос типа позиции спецификации при клонировании сделки

- Напоминания
  - исправление редактирования группового напоминания в части Исполнители
  - отображение исполнителей в разделе "Дела"
  - отображение признака группового напоминания в разделе "Дела" Рабочего стола

- Панель управления
  - исправлен конструктор "Поля по этапам сделок"

- Виджеты
  - адаптация некоторых виджетов под MySQL 8.0

- Модуль "Почтовик"
  - добавлен поиск писем по email отправителя
  - добавление в историю активностей всех писем при привязке email к определенному Клиенту или Контакту


<a id="01022021"></a>
# Версия - 2020.3 (Fix)
#### от 01.02.2021 (build 01022021)

## Исправления

- Панель управления
  - исправлен конструктор "Поля по этапам сделок" в части обязательных полей

- План продаж
  - исправлен импорт (были перепутаны планы по обороту и марже)

- Модуль "Каталог-склад"
  - небольшие правки
  
- Обновлен Adminer


<a id="22012021"></a>
# Версия - 2020.3 (Fix)
#### от 22.01.2021 (build 22012021)

## Исправления

- Исправлено удаление напоминания на вкладке Рабочего стола
  
- Раздел "История активностей"
    - отключение выбора пользователей для роль "Менеджер продаж" при отсутствии доступа к чужим активностям

- Модуль "Документы"
    - Раздел "Список документов"
      - отключение доступа к чужим записям для роли "Менеджер продаж", если нет прав "Может просматривать чужие записи"

- Модуль "Почтовик"
    - корректировка обработки писем, отправленных из Outlook ( кодировка )
  
- Модуль "Проекты"
    - исправлено удаление Задания в карточке Проекта
    - автопреобразование ссылок в комментариях


<a id="11012021"></a>
# Версия - 2020.3 (Fix)
#### от 11.01.2021 (build 11012021)

## Исправления

- Оптимизация некоторых виджетов
- Различные исправления

- Модуль "Обработчик заявок"
    - исправлена обработка типа клиента, установленная по-умолчанию


<a id="04012021"></a>
# Версия - 2020.3 (Fix)
#### от 04.01.2021 (build 04012021)

## Исправления

- Поддержка PHP 7.3
- Поддержка MySQL 8.0 (Требуется в конфиг MySQL внести строку: sql_mode = "NO_ENGINE_SUBSTITUTION")

- Плагин "Чаты и мессенджеры"
    - исправление для поддержки MySQL 8.0

- Модуль "Проекты"
    - исправлено невозможность смены статуса Проекта в некоторых случаях


<a id="18122020"></a>
# Версия - 2020.3 (Fix)
#### от 18.12.2020 (build 18122020)

>
> <b class="red">Важно:</b> Требуется запуск скрипта /_install/update.php для внесения изменений в структуру БД
>

## Исправления

- Модуль "Проекты"
    - добавлена возможность изменения статуса Проекта для Администратора и Автора ( помимо Куратора ) в списках, в карточке Проекта
    - исправлено удаление файлов из Работ
    - возможность указать дату закрытия и комментарий к закрытию Проекта, если Проект закрывается сразу после создания
    - исправлена установка даты закрытия Проекта и Работ

- Модуль "Метрика"
    - добавлена защита от нулевых сезонных коэффициентов

- Модуль "Обработчик заявок"
    - исправлена ошибка при импорте
    - исправлена обработка типа клиента, установленная по-умолчанию

- Модуль "Бюджет"
    - возможность удаления разделов/статей с переносом зависимых записей

- Раздел Напоминания
    - применение фильтров "по запросу"
    - добавлен фильтр по признаку "Приоритет"

- Разное
    - раздел Панель управления / События в системе - исправлен переход по страницам


<a id="18112020"></a>
# Версия - 2020.3 (Fix)
#### от 18.11.2020 (build 18112020)

## Исправления

- Плагин "Чаты и мессенджеры"
    - исправлено получение кода для установки кнопки на сайт

- Модуль "Проекты"
    - исправлено пропадение последнего комментария при редактировании проекта

- Модуль "Почтовик"
    - продолжаем работать с проблемами в кодировках
    - исправлена проблема сохранения сообщений в историю

- Плагин "Планировщик заданий"
    - исправлен крон-скрипт проверки почты сотрудников
    
- Раздел "История активностей"
    - исправлен фильтр для событий типа "СобытиеCRM", "ЛогCRM"


<a id="03112020"></a>
# Версия - 2020.3 (Fix)
#### от 03.11.2020 (build 03112020)

## Исправления

- Модуль "Сборщик заявок"
    - исправлен ручная проверка заявок
    - исправлена работа групповых действий

- Модуль "Проекты"
    - исправлена проблема перевода статуса работ
    - добавлен шаблон колонок по умолчанию


<a id="29102020"></a>
# Версия - 2020.3 (Fix)
#### от 29.10.2020 (build 29102020)

## Исправления

- Модуль "Почтовик"
    - исправлена работа с автоподписью, связанная с вставкой изображений

- Плагин "Чаты и мессенджеры"
    - не большие исправления


<a id="23102020"></a>
# Версия - 2020.3 (Fix)
#### от 23.10.2020 (build 23102020)

## Исправления

- Модуль "Проекты"
    - вывод последнего комментария смены статуса под описанием Проекта/Работы ( синим цветом ) во всех разделах
    - отправка email-уведомления для всех статусов Проекта ( применяется шаблон при выполнении Проекта )


<a id="20102020"></a>
# Версия - 2020.3 (Fix)
#### от 20.10.2020 (build 20102020)

## Исправления

- Активности и Напоминания
    - восстановлена подгрузка быстрых ответов

- Прочее
    - исправлен экспорт спецификации из карточки сделки
    - исправлен тип клиента по умолчанию в формах
    - исправлено форматирование телефона


<a id="15102020"></a>
# Версия - 2020.3 (Fix)
#### от 15.10.2020 (build 15102020)

>
> <b class="red">Важно:</b> Требуется запуск скрипта /_install/update.php, если модуль Проекты установлен и используется
>

## Исправления

- Активности и Напоминания
    - добавлена возможность назначить собственную иконку для типов Активности
    - добавлено сохранение фильтров ( по типам активности, период выборки в разделе Активности )

- Дополнительные опции в правах сотрудников
    - запрет добавления любых активностей
    - запрет выполнения чужих напоминаний ( для руководителей )

- Модуль "Проекты":
    - добавлен Конструктор статусов для Проектов и Работ
        - Статус Проекта или Работы можно изменить только через отдельное действие
        - Необходимо сопоставить статусы:
            - Завершающий - дает системе понять, что при переходе на этот статус происходит завершение Проекта/Работы
            - Отмена - дает системе понять, что завершение Проекта/Работы происходит с отменой ( указывается в сочетании с признаком Завершения )
            - Только кураторы - дает системе понять, что переводить Проект/Работу на указанный статус могут только Кураторы
        - Каждому статусу присваивается Иконка и Цвет с возможностью выбора ( из набора )
    - исправлены найденные ошибки
    - добавлено сохранение фильтров
    - в колонке Описание у работ добавлен вывод последнего комментария смены статуса, если он заполнен


<a id="05102020"></a>
# Версия - 2020.3 (Fix)
#### от 05.10.2020 (build 05102020)

## Исправления

- Исправления для отчета Выполнение планов ( ent-planDoByPayment.php )
- Доработка cron-скрипта для очистки системы ( cronCleaner.php )
- Исправлены ссылки на карточке во всплывающем окне напоминания

- Модуль "Проекты":
    - исправление добавления типа работ


<a id="26092020"></a>
# Версия - 2020.3 (Fix)
#### от 26.09.2020 (build 26092020)

## Исправления

- API для разработчиков
    - добавлена возможность вывода списка Сделок, Клиентов по дате изменения (по полю date_change)
    - добавлены синонимы для полей (применяются в fields, order):
        - date_create = datum - дата создания сделки
        - date_change = datum_izm - дата изменения сделки
        - date_start  = datum_start - дата начала периода
        - date_end    = datum_end - дата конца периода сделки
        - date_close  = datum_close - дата закрытия сделки
        - date_chage  = date_edit - дата изменения клиента

- Уведомления (внутренние)
    - исправлена работа уведомлений при смене Ответственного за Клиента, Сделку


<a id="17092020"></a>
# Версия - 2020.3 (Fix)
#### от 17.09.2020 (build 17092020)

## Исправления

- Раздел "Отчеты"
    - исправление выбора произвольной даты

- Почтовик
    - исправление отображения названия месяца в PDF-версии счета, сгенерированной при составлении письма

- Карточка Клиента, Контакта, Сделки
    - исправление перехода по страницам блока Истории активности


<a id="11092020"></a>
# Версия - 2020.3 (Fix)
#### от 11.09.2020 (build 11092020)

## Исправления

- Рабочий стол / Список дел
    - исправлен фильтр "Только мои", для показа только собственных напоминаний

- Настройки интеграции с телефонией:
    - исправлены ссылки для получения имени абонента по номеру

- Модуль "Корпоративный университет":
    - исправление работы

- Плагин "Чаты и Мессенжеры":
    - исправление работы с каналом Whatsapp
        - дозагрузка имени, если оно не загрузилось ранее
        - загрузка аватара, если клиент впервые написал нам (впервые для сервера Whatsapp)


<a id="09092020"></a>
# Версия - 2020.3 (Fix)
#### от 09.09.2020 (build 09092020)

## Исправления

- Плагин "Чаты и Мессенжеры":
    - исправление работы с каналом Whatsapp
- Плагины, работающие с Telegram
    - исправление ошибки, связанной с прокси-сервером


<a id="25082020"></a>
# Версия - 2020.3 (Fix)
#### от 25.08.2020 (build 25082020)

## Исправления

- исправлен cron-скрипт для создания дампа БД ( /cron/backup.php )
- исправлен выбор периода в отчете "Выполнение плана по месяцам" ( ent-planDoByPayment.php )
- модуль "Метрика":
    - добавлена строка итоговых сумм для плана по продажам
    - добавлена кнопка открытия отчета "Выполнение плана по месяцам"


<a id="21082020"></a>
# Версия - 2020.3 (Fix)
#### от 21.08.2020 (build 21082020)

## Исправления

- API
    - исправлено получение информации о клиенте по его ИНН


<a id="17082020"></a>
# Версия - 2020.3 (Relise)
#### от 17.08.2020 (build 17082020)

>
> <b class="red">Важно:</b> Требуется запуск скрипта /_install/update.php
>

## Глобальные

- Отказ от поддержки PHP 5.6
- Поддержка PHP 7.2 и выше ( мы проверили работу на PHP 7.4 - работает отлично )

- Изменена структура папок проекта:
    - папка /_install/ - в неё перемещены скрипты установки и обновления, а также скрипты фиксов + добавлен интерфейс для доступа к этим скриптам
    - папка /assets/ - в неё перемещены папки js, css, font, images
    - папка /files/backup/ - новое хранилище резервных копий БД ( перенесено из /admin/backup/ )
    - папка /content/card/ - скрипты для карточек Сделок, Клиентов, Контактов ( перенесено из /card/ )
    - папка /content/vigets/ - новое хранилище виджетов
    - папка /content/pbx/ - в неё перемещено всё, что связано с интеграцией с АТС ( из папки /api/ )


## Добавлено

- Плагин [Планировщик заданий](https://salesman.pro/docs/155), позволяющий управлять заданиями Crontab в рамках автоматизаций для CRM. Также добавлены скрипты:
    - Резервное копирование БД
    - Проверка почты сотрудников ( для Почтовика )
    - Проверка заявок
    - Синхронизация истории звонков ( для телефонии )
    - Отправка списка дел на текущий день по email
    
- Плагин [Контрольные точки](https://salesman.pro/docs/154#controlPoints), выводит индикатор Контрольных точек с отображением списка ( если сотрудник является ответственным за КТ )

- Плагин [Сохранение формы](https://salesman.pro/docs/154#saveForm) напоминания по Ctrl + Enter

- Плагин [Отделы для отчетов](https://salesman.pro/docs/154#otdelFilter) - добавляет список выбора отдела

- Плагин [Чаты и мессенджеры](https://salesman.pro/docs/152) - добавлена возможность написать первым через канал Whatsapp по номеру мобильного из карточки Клиента / Контакта


## Исправления и Дополнения

- Рабочий стол 
    - проведен рефакторинг и оптимизация

- Раздел "Напоминания"
    - исправлен фильтр по напоминаниям, привязанным к сделкам

- История активности 
    - отображение связанного напоминания при отсутствии прав на редактирование/удаление активностей
    
- Интерфейс
    - новые блоки для индикаторов плагинов (Пользователи онлайн, Чаты и мессенджеры и пр.)
    - новые блоки для кнопок обновить, телефонии
    
- Управление отчетами 
    - добавлен поиск отчета по названию или названию файла
    
- Сделки 
    - раздел: добавлен поиск по названию клиента
    - карточка клиента: возможность сортировки списка сделок по плановой дате ( сначала новые, сначала старые )
    - карточка сделки: вывод краткой информации по активным и закрытым сделкам

- Универсальный поиск
    - увеличена высота окна
    - опция "строгий поиск" перенесена в видимую зону
    - улучшен поиск сделок со сложным названием без опции "строгий поиск" ( например: М45.43.ПР345/45 )

- Разделы Клиенты, Контакты, Сделки
    - оптимизирован расчет количества записей для больших баз, что приводило к долгой обработке

- Разное
    - исправлен начальный установочный дамп
    - улучшен инсталлятор
    - исправлен перенос дел в Календаре на месяц
    - исправлены некоторые отчеты


## Модули

### Метрика

- Учет в KPI по активностям только активности не привязанные к Напоминаниям или активности, привязанные к Напоминаниям с успешным выполнением
- Добавлены коэффициенты "Сезонности": позволяет изменять базовое значение KPI для определенных месяцев (не применим к Квартальным и Годовым показателям)
- Добавлена возможность установить показатель для нескольких сотрудников

### Центр исходящих звонков

- Исправления в статистике
- Доступ в раздел для Администраторов и Руководителя организации
- Отображение отчетов по всем операторам для Администраторов и Руководителя организации

### Почтовик
- исправлена проблема с сохранением некоторых шаблонов писем
- выбор изображений на сервере: добавлен постраничный вывод
- изображения дл автоподписей: принудительное уменьшение ширины до 300px
- смешанное представление Входящие + Исходящие


## Плагины

- Переработаны все плагины под новую структуру папок системы, исправлены ошибки

### Исправления

- Доработаны плагины "Статистика", "Чаты и мессенджеры", "Уведомление пользователей" в части интеграции с Телеграм (из-за разблокировки РКН)
- Исправления в плагине "Универсальный автоотправитель"


## Разработчикам

- Исправлено подключение PHP Hook для плагинов
- Добавлено срабатывание Webhook для событий, инициированных через API
- Расширение API: 
    - метод **client** - возможность поиска клиента по ИНН
    - метод **client** - возможность получения всех контактов по клиенту
    - добавлен метод **currency** - управление валютами

# Установка обновления

- Версия требует новый ключ
- В состав дистрибутива включен бесплатный однопользовательский ключ.
- Для установки требуется
    - сохранить резервные копии БД (из папки /admin/backup/) или переместить их в папку /files/backup/
    - сохранить кастомные виджеты из папки /vigets/
    - удалить все файлы и папки системы, кроме:
        -  папка /cash/
        -  папка /files/
        -  папка /inc/
        -  папка /reports/
        -  папка /plugins/
    - удалить все файлы ключей из папок плагинов ( salesman.ion ) - они больше не нужны
    - перенос файла «/api/asterisk/settings.json» в /content/pbx/asterisk/ – если используется интеграция с Asterisk PBX
    - загрузить на сервер обновленные файлы (дистрибутив — только обновление),
    - запустить скрипт /_install/update.php

<iframe width="560" height="315" src="https://www.youtube.com/embed/aaz3ov0uVfk" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>